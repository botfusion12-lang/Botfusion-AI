<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BotFusion AI</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00a77b">
<style>
/* Reset and fonts */
* { margin:0; padding:0; box-sizing:border-box; font-family:Poppins,sans-serif; }
body { background:#121212; color:#fff; }
.panel {
  position: fixed;
  top: 10%;
  right: 5%;
  width: 90%;
  max-width: 420px;
  background: #111;
  color: white;
  border-radius: 14px;
  padding: 18px;
  box-shadow: 0 0 20px rgba(0,0,0,0.4);
  z-index: 20;
}

.hidden {
  display: none;
}

.panel h2 {
  margin-top: 0;
}
/* Header */
header {
  display:flex; justify-content:space-between; align-items:center;
  padding:15px 20px; background:#1A1A1A; position:fixed; top:0; width:100%; z-index:100;
  box-shadow:0 2px 8px rgba(0,0,0,0.4);
}
header .hamburger, header .profile { cursor:pointer; font-size:1.5rem; color:#00a77b; }
header h1 { font-size:1.3rem; color:#fff; }

/* Sidebar */
.sidebar {
  position:fixed; top:0; left:-260px; width:260px; height:100%;
  background:#1e1e1e; transition:0.3s; padding-top:70px; z-index:90;
  display:flex; flex-direction:column; justify-content:space-between;
}
.sidebar.active { left:0; }
.sidebar button {
  display:flex; align-items:center; width:100%;
  padding:12px 20px; background:none; border:none; color:#fff;
  text-align:left; font-size:1rem; cursor:pointer; border-radius:0;
}
.sidebar button:hover { background:#333; }
.sidebar button svg { margin-right:12px; width:20px; height:20px; fill:#00a77b; }
.sidebar .bottom { margin-bottom:20px; }

/* Main content */
main { padding:90px 20px 100px; min-height:100vh; overflow-y:auto; }
main h2 { font-size:1.4rem; margin-bottom:20px; text-align:center; }
.card {
  background:#1e1e1e; padding:15px 20px; margin:10px 0;
  border-radius:15px; cursor:pointer; transition:0.2s; display:flex; align-items:center;
}
.card:hover { background:#333; }
.card svg { margin-right:15px; width:24px; height:24px; fill:#00a77b; }

/* Chat input */
.chat-input {
  position:fixed; bottom:0; left:0; width:100%;
  display:flex; background:#1e1e1e; padding:10px 15px; z-index:100;
}
.chat-input input {
  flex:1; padding:12px 20px; border:none; border-radius:25px 0 0 25px;
  outline:none; background:#2a2a2a; color:#fff; font-size:1rem;
}
.chat-input button {
  padding:0 20px; border:none; border-radius:0 25px 25px 0;
  background:#00a77b; color:#fff; cursor:pointer; font-size:1rem;
}

/* Modal */
.modal {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:200;
}
.modal.active { display:flex; }
.modal-content {
  background:#1e1e1e; padding:20px; border-radius:15px; width:90%; max-width:400px;
}
.modal-content h3 { margin-bottom:15px; text-align:center; }
.modal-content button { margin-top:10px; padding:10px 15px; border:none; border-radius:8px; background:#00a77b; color:#fff; cursor:pointer; }

/* Language dropdown */
select { background:#2a2a2a; color:#fff; border:none; border-radius:8px; padding:8px 12px; font-size:1rem; margin-bottom:10px; width:100%; }

/* Generated images styling */
.generated-image { max-width:100%; border-radius:12px; margin:10px 0; }
</style>
</head>
<body>

<header>
  <div class="hamburger">
    <svg viewBox="0 0 100 80" width="24" height="24"><rect width="100" height="15"></rect><rect y="30" width="100" height="15"></rect><rect y="60" width="100" height="15"></rect></svg>
  </div>
  <h1>BotFusion AI</h1>
  <div class="profile">
    <svg viewBox="0 0 24 24"><path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/></svg>
  </div>
</header>

<div class="sidebar">
  <div>
    <button data-action="new-chat">New Chat</button>
    <button data-action="history">History</button>
    <button data-action="summarize">Summarize</button>
    <button data-action="analyze">Analyze</button>
    <button data-action="create">Create Image</button>
    <button data-action="list">Make List</button>
    <button data-action="code">Coding</button>
    <button onclick="openProfile()">üë§</button>
    <button onclick="openSettings()">‚öôÔ∏è</button>
  </div>
  <div class="bottom">
    <button data-action="settings">Settings</button>
    <button data-action="account">Account</button>
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="hi">Hindi</option>
      <option value="mr">Marathi</option>
      <!-- Add 100+ languages -->
    </select>
  </div>
</div>

<main id="mainContent">
  <h2>How can I help you today?</h2>
</main>

<div class="chat-input">
  <input type="text" id="chatInput" placeholder="Message BotFusion...">
  <button id="sendBtn">&#8593;</button>
</div>

<!-- Modals -->
<div class="modal" id="settingsModal">
  <div class="modal-content">
    <h3>Settings</h3>
    <button onclick="closeModal('settingsModal')">Close</button>
  </div>
</div>
<div class="modal" id="accountModal">
  <div class="modal-content">
    <h3>Account / Google Login</h3>
    <button onclick="closeModal('accountModal')">Close</button>
  </div>
</div>
<!-- PROFILE PANEL -->
<div id="profilePanel" class="panel hidden">
  <h2>My Profile</h2>
  <p>Name: Guest</p>
  <p>Email: Not logged in</p>

  <button onclick="closePanel()">Close</button>
</div>

<!-- SETTINGS PANEL -->
<div id="settingsPanel" class="panel hidden">
  <h2>Settings</h2>

  <label>Language</label>
  <select>
    <option>English</option>
    <option>Hindi</option>
    <option>Marathi</option>
  </select>

  <label>Theme</label>
  <select>
    <option>Dark</option>
    <option>Light</option>
  </select>

  <button onclick="closePanel()">Close</button>
</div>
<script>
const sidebar = document.querySelector('.sidebar');
const hamburger = document.querySelector('.hamburger');
const profile = document.querySelector('.profile');
const mainContent = document.getElementById('mainContent');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');

// Toggle sidebar
hamburger.addEventListener('click',()=>sidebar.classList.toggle('active'));
document.addEventListener('click', e=>{
  if(!sidebar.contains(e.target) && !hamburger.contains(e.target)) sidebar.classList.remove('active');
});

// Sidebar button actions
sidebar.querySelectorAll('button').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const action=btn.dataset.action;
    if(action==='settings') openModal('settingsModal');
    else if(action==='account') openModal('accountModal');
    else if(action==='create') createImage();
    else sendFeature(action);
    sidebar.classList.remove('active');
  });
});

// Profile click
profile.addEventListener('click', ()=>openModal('accountModal'));

// Send chat
sendBtn.addEventListener('click', sendMessage);
chatInput.addEventListener('keypress', e=>{ if(e.key==='Enter') sendMessage(); });

// Functions
function openModal(id){ document.getElementById(id).classList.add('active'); }
function closeModal(id){ document.getElementById(id).classList.remove('active'); }

function addMessage(sender,text){
  const msg=document.createElement('div');
  msg.classList.add('card',sender);
  msg.textContent=text;
  mainContent.appendChild(msg);
  mainContent.scrollTop=mainContent.scrollHeight;
}

// Send normal chat
async function sendMessage(){
  const text=chatInput.value.trim();
  if(!text) return;
  addMessage('user',text);
  chatInput.value='';
  try{
    const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:text,lang:document.getElementById('languageSelect').value})});
    const data=await res.json();
    addMessage('bot',data.reply);
  }catch(err){ console.error(err); addMessage('bot','Error connecting backend.'); }
}

// Feature buttons
async function sendFeature(feature){
  const text=chatInput.value.trim();
  if(!text) return;
  addMessage('user',text);
  try{
    const res=await fetch(`/api/chat?feature=${feature}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:text,lang:document.getElementById('languageSelect').value})});
    const data=await res.json();
    addMessage('bot',data.reply);
  }catch(err){ console.error(err); addMessage('bot','Error connecting backend.'); }
}
function openProfile() {
  document.getElementById("profilePanel").classList.remove("hidden");
}

function openSettings() {
  document.getElementById("settingsPanel").classList.remove("hidden");
}

function closePanel() {
  document.getElementById("profilePanel").classList.add("hidden");
  document.getElementById("settingsPanel").classList.add("hidden");
}
// Create image
async function createImage(){
  const prompt=chatInput.value.trim();
  if(!prompt) return;
  addMessage('user',prompt);
  try{
    const res=await fetch('/api/image',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt})});
    const data=await res.json();
    addMessage('bot','üñºÔ∏è Image generated!');
    const img=document.createElement('img');
    img.src=data.url;
    img.classList.add('generated-image');
    mainContent.appendChild(img);
  }catch(err){ console.error(err); addMessage('bot','Error generating image.'); }
}

// Register service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js')
    .then(()=>console.log('Service Worker registered!'))
    .catch(err=>console.log('SW registration failed:',err));
}
</script>
</body>
</html>
